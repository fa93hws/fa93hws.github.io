(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{508:function(e,t,n){e.exports={container:"container--2JG7i",list:"list--oKH1Q","no-comment":"no-comment--1UTTU",noComment:"no-comment--1UTTU",item:"item--2tDzY",header:"header--3Hk6D","header-left":"header-left--2ssXV",headerLeft:"header-left--2ssXV",avatar:"avatar--2dvyY","header-right":"header-right--152Dx",headerRight:"header-right--152Dx",name:"name--1hVIg","is-author":"is-author--9rnaF",isAuthor:"is-author--9rnaF",time:"time--E3I9K",reply:"reply--37qPC",row:"row--8IJiF","row-1":"row-1--35H1d",row1:"row-1--35H1d",body:"body--2N56q"}},510:function(e,t,n){"use strict";n.r(t);var o=n(1),r=n.n(o),a=n(85),s=n(509),i=n(421),c=n(415),u=n(416);function l(e,t){return void 0===t&&(t=!1),{name:"comments",search:e,children:["totalCount",{name:"nodes",children:["publishedAt","id","body",{name:"bodyHTML",alias:"content"},Object(u.a)(["name","avatarUrl","url","email","id"]),function(e){var t=["content",{name:"users",children:["totalCount"]}];return!0===e&&t.push("viewerHasReacted"),{name:"reactionGroups",children:t}}(t)]}]}}var m,h=n(412),f=n(37),p=n(417),d=function(){return function(e){var t=this;this.up=0,this.down=0,this.love=0,this.laugh=0,this.hooray=0,this.confused=0,e.forEach(function(e){switch(e.content){case"THUMBS_UP":t.up=e.users.totalCount;break;case"THUMBS_DOWN":t.down=e.users.totalCount;break;case"HEART":t.love=e.users.totalCount;break;case"LAUGH":t.laugh=e.users.totalCount;break;case"HOORAY":t.hooray=e.users.totalCount;break;case"CONFUSED":t.confused=e.users.totalCount;break;default:throw new Error("unknown reaction type "+e.content)}})}}(),b=(m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),y=function(e,t,n,o){var r,a=arguments.length,s=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(s=(a<3?r(s):a>3?r(t,n,s):r(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},C=function(e){function t(t){var n=e.call(this,t)||this;return n.author=new p.a(t.author),n.reactions=new d(t.reactionGroups),n}return b(t,e),Object.defineProperty(t.prototype,"timeStr",{get:function(){var e=new Date(this.publishedAt),t=(new Date).getTime()-e.getTime();return t<6e4?Math.floor(t/1e3)+" 秒前":t<36e5?Math.floor(t/60/1e3)+" 分钟前":t<864e5?Math.floor(t/3600/1e3)+" 小时前":(void 0===this._timeStr&&void 0!==this.publishedAt&&""!==this.publishedAt&&(this._timeStr=this.publishedAt.split("T")[0].replace("-","年").replace("-","月")+"日"),this._timeStr)},enumerable:!0,configurable:!0}),t.prototype.parseGQResponse=function(e){this.id=e.id,this.publishedAt=e.publishedAt,this.content=e.content,this.author=new p.a(e.author),this.reactions=new d(e.reactionGroups)},y([f.a],t.prototype,"parseGQResponse",null),t}(h.a),v=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),w=function(e,t,n,o){var r,a=arguments.length,s=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(s=(a<3?r(s):a>3?r(t,n,s):r(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.totalCount=0,t.contents=[],t}return v(t,e),t.prototype.parseGQResponse=function(e){var t=this;this.totalCount=e.totalCount,e.nodes.forEach(function(e){return t.contents.push(new C(e))})},w([f.a],t.prototype,"parseGQResponse",null),t}(h.a),O=function(){function e(e,t){this.totalCount=0,this.freshComments=[],this.oldComments=[],this.totalCount=e.totalCount,this.freshComments=e.contents,this.oldComments=t.contents,this.organizeComments()}return Object.defineProperty(e.prototype,"hasUnloaded",{get:function(){return 0!==this.numUnloaded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numUnloaded",{get:function(){var e=this.totalCount-this.freshComments.length-this.oldComments.length;return Math.max(0,e)},enumerable:!0,configurable:!0}),e.prototype.organizeComments=function(){if(!this.hasUnloaded){if(this.totalCount!==this.freshComments.length){var e=this.freshComments[this.freshComments.length-1],t=this.oldComments.findIndex(function(t){return t.id===e.id}),n=this.oldComments.slice(t+1);this.freshComments=this.freshComments.concat(n)}this.oldComments=[]}},e.prototype.addComments=function(e){var t=this;e.forEach(function(e){return t.freshComments.push(e)}),this.organizeComments()},w([f.a],e.prototype,"organizeComments",null),w([f.a],e.prototype,"addComments",null),e}(),E=function(e){return Object(c.e)([Object(c.b)(e,[(t=l({first:10}),t.alias="freshComments",t),function(){var e=l({last:10});return e.alias="oldComments",e}()])]);var t},_=function(e){return new Promise(function(t,n){i.a.post(E(e)).then(function(e){var n=e.issue,o=n.freshComments,r=n.oldComments,a=new g;a.parseGQResponse(o);var s=new g;s.parseGQResponse(r);var i=new O(a,s);t(i)}).catch(n)})},j=n(508),N=n.n(j);function R(e){var t=e.manager;return 0===t.totalCount?r.a.createElement("p",{className:N.a.noComment},"还没有评论"):r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:N.a.list},t.freshComments.map(function(e){return r.a.createElement(A,{comment:e,key:e.id})})))}function A(e){var t=e.comment,n=Object(o.useContext)(s.BlogContext),a=Object(o.useMemo)(function(){return n.author.id===t.author.id?N.a.name+" "+N.a.isAuthor:N.a.name},[t.author.displayName]);return r.a.createElement("li",{className:N.a.item},r.a.createElement("article",null,r.a.createElement("header",{className:N.a.header},r.a.createElement("div",{className:N.a.headerLeft},r.a.createElement("a",{href:t.author.url,target:"_blank"},r.a.createElement("img",{className:N.a.avatar,src:t.author.avatarUrl}))),r.a.createElement("div",{className:N.a.headerRight},r.a.createElement("p",{className:N.a.row},r.a.createElement("a",{target:"_blank",className:a,href:t.author.url},t.author.displayName)),r.a.createElement("p",{className:[N.a.row,N.a.row1].join(" ")},r.a.createElement("time",{className:N.a.time,dateTime:t.publishedAt},t.timeStr),r.a.createElement("a",{className:N.a.reply},"回复")))),r.a.createElement("p",{className:[N.a.body,"markdown-body"].join(" "),dangerouslySetInnerHTML:{__html:t.content}})))}function U(){var e=Object(o.useContext)(s.BlogContext),t=Object(o.useState)(null),n=t[0],i=t[1],c=Object(o.useMemo)(function(){return null!==n},[n]);return Object(o.useEffect)(function(){_(e.number).then(i)},[]),r.a.createElement("section",{className:N.a.container},c?r.a.createElement(R,{manager:n}):r.a.createElement(a.a,null))}n.d(t,"default",function(){return U})}}]);